# CourierMini — Техническое задание (MVP)  
Telegram Mini App — служба экспресс-доставки

**Дата:** 24 февраля 2026  
**Статус:** черновик MVP  
**Язык интерфейса:** Русский (обязательно)  
**Язык документации:** Русский  
**Тип приложения:** Telegram Mini App (Web App)

## 1. Цели и аудитория

**Главная цель**  
Дать возможность любому пользователю Telegram за 15–30 секунд вызвать курьера для доставки небольшого груза / документов / посылки «от двери до двери».

**Ключевые ценности MVP:**
- Максимально быстрое создание заказа
- Минимум полей для заполнения
- Работа полностью внутри Telegram
- Простая система для курьеров (принять → забрать → доставить)

**Целевая аудитория MVP**
- 18–45 лет
- Активные пользователи Telegram
- Жители городов-миллионников
- Типичные кейсы: документы, цветы, еда из магазинов, небольшие посылки до 5–8 кг

## 2. Технический стек (рекомендация 2026)

- Frontend: React / Vite + TypeScript  
  (альтернативы: Next.js App Router, Vue, SvelteKit)
- Telegram Web App SDK: `@telegram-apps/sdk-react` или `@tma.js/sdk`
- State management: Zustand / Jotai / React Context
- UI-библиотека:shadcn/ui + Tailwind CSS (или Telegram-совместимые компоненты)
- Backend: Node.js (Fastify / NestJS) / serverless (Vercel / Cloudflare Workers)
- База данных: PostgreSQL + Prisma / Supabase Postgres / Firebase
- Хранение файлов (фото посылок): Supabase Storage / Cloudflare R2 / S3-совместимое
- Аутентификация: Telegram `initData` (обязательная серверная валидация)
- Уведомления: Telegram Bot API (sendMessage)
- Платежи (опционально в MVP): Telegram Stars / ЮKassa / CloudPayments

## 3. Роли пользователей

| Роль          | Основные действия в MVP                                      |
|---------------|---------------------------------------------------------------|
| Клиент        | Создаёт заказ, отслеживает статус, общается с курьером        |
| Курьер        | Видит новые заказы, принимает, меняет статусы, общается       |
| Администратор | (минимально) просмотр заказов, блокировка пользователей       |

## 4. Структура навигации (MainButton + Bottom Menu)

| Экран                  | Для кого   | Ключевые элементы интерфейса                                      |
|------------------------|------------|-------------------------------------------------------------------|
| Главный / Создать заказ| Клиент     | Кнопка «Вызвать курьера», быстрые шаблоны, текущие заказы         |
| Мои заказы             | Клиент     | Список активных + завершённых, статус, кнопка «Связаться»         |
| Заказы (пулы)          | Курьер     | Список новых заказов, сортировка (цена / расстояние / срочность)  |
| Детали заказа          | Все        | Адреса, описание, фото, чат, кнопки изменения статуса             |
| Профиль                | Все        | Баланс, статус курьера, настройки уведомлений, контакты           |
| Онбординг (первый запуск) | Все     | 3–4 слайда + кнопка «Начать»                                      |

## 5. Основной сценарий — Клиент

1. Открывает Mini App
2. (первый раз) → онбординг 3–4 экрана
3. Нажимает «Вызвать курьера» / «Новый заказ»
4. Заполняет минимум полей:
   - Откуда забрать (геолокация Telegram или ручной ввод адреса)
   - Куда доставить
   - Что везём (выбор из 5–7 категорий + поле «описание»)
   - Вес / габариты (примерно)
   - Когда нужно: «Как можно скорее» / выбор времени
   - Фото посылки (опционально, 1–3 фото)
   - Комментарий
5. Видит расчётную стоимость (или «договоримся с курьером»)
6. Нажимает «Найти курьера»
7. Получает статусы: «Ищем курьера» → «Курьер назначен» → чат открывается

## 6. Основной сценарий — Курьер

1. В профиле включает статус «Готов брать заказы»
2. На вкладке «Заказы» видит карточки новых заявок
3. Карточка содержит:
   - Расстояние
   - Предполагаемая оплата
   - Категория и краткое описание
   - Время создания / срочность
4. Нажимает «Взять заказ» → закрепление за курьером
5. Меняет статусы:
   - Принял → Забрал → В пути → Доставлено
6. После «Доставлено» клиент подтверждает → заказ завершён

## 7. Структура данных (пример)

```ts
interface Order {
  id:                string;                    // uuid
  clientTgId:        number;                    // telegram user id
  courierTgId:       number | null;
  fromAddress:       string;
  toAddress:         string;
  pickupGeo?:        { lat: number; lng: number };
  dropoffGeo?:       { lat: number; lng: number };
  category:          'documents' | 'package' | 'flowers' | 'food' | 'other';
  description:       string;
  weightKgApprox:    number;                    // 0.5, 1, 3, 5, 8...
  photos:            string[];                  // url-ы
  price:             number | null;             // если null → договариваются
  status:            'new' | 'accepted' | 'picked_up' | 'in_progress' | 'delivered' | 'cancelled' | 'problem';
  createdAt:         string;                    // ISO
  pickupDesiredAt:   string | 'asap';
  completedAt?:      string;
  clientComment?:    string;
  courierComment?:   string;
}


## 8. Обязательный функционал MVP (must-have)

- Полная серверная валидация Telegram `initData` (защита от подмены пользователя)
- Получение текущей геолокации пользователя через `Telegram.WebApp.requestLocation`
- Возможность загрузить 1–3 фотографии посылки (через input type="file" + upload на бэкенд)
- Отправка push-уведомлений через Telegram-бота:
  - клиенту: новый статус заказа, назначен курьер, курьер в пути и т.д.
  - курьеру: новый заказ в радиусе, заказ взят другим курьером и т.п.
- Базовая формула расчёта стоимости (примеры вариантов):
  - фиксированная по зонам города
  - 150–200 ₽ база + 30–50 ₽ за км + 20–40 ₽ за кг
  - или «цена по договорённости с курьером»
- Ограничение на создание заказов (rate limit): не чаще 1 заказа в 2–5 минут с одного аккаунта
- Короткий онбординг при первом запуске (3–5 экранов / слайдов)
- Минимальная валидация адресов (хотя бы проверка, что поле не пустое)

## 9. Функционал, который можно и нужно отложить (nice-to-have / 2–3 итерация)

- Показ текущего местоположения курьера на карте в реальном времени
- Система рейтингов и отзывов после завершения заказа (1–5 звёзд + текст)
- Интеграция с внешними картами (Яндекс.Карты API / 2GIS) для:
  - точного расчёта расстояния и цены
  - построения маршрута
- Автоматический вывод заработка курьерам (СБП, банковская карта, крипта и т.д.)
- Промокоды, реферальные ссылки, бонусные рубли
- Разделение курьеров по типу транспорта уже на этапе поиска (пеший / велосипед / авто / скутер)
- Поддержка нескольких городов с разными тарифными зонами и правилами
- Возможность отмены заказа клиентом с возвратом предоплаты (если была)
- Расширенный чат: отправка голосовых, документов, локаций в процессе доставки
- Статистика для курьера (заработок за день/неделю, количество заказов, рейтинг)

## 10. Критические вопросы к заказчику / инвестору (до начала активной разработки)

1. Обязательна ли предоплата в MVP или допустим полностью наложенный платёж курьеру при вручении?
2. Какой максимальный вес и примерные габариты посылки планируются в первой версии?  
   (рекомендуется: до 8–10 кг и не больше 60×40×40 см)
3. Нужно ли уже в MVP разделять курьеров по способу передвижения (пеший / вело / авто)?
4. Какой процент комиссии сервиса планируется брать с каждого заказа? (10–25% — типичный диапазон)
5. Есть ли уже брендбук, логотип, фирменные цвета, желаемое название приложения?
6. В каких городах и/или конкретных районах планируется тестовый запуск?
7. Должна ли отображаться ориентировочная цена до того, как курьер возьмёт заказ?
8. Планируется ли минимальная сумма заказа (например, от 200–300 ₽)?
9. Будет ли в MVP требоваться верификация курьеров (фото паспорта, права, номер телефона)?
10. Какой средний чек доставки ожидается в первые месяцы?

## 11. Рекомендуемый порядок реализации экранов (примерный план спринтов)

1. Аутентификация + онбординг + профиль (1–2 недели)
2. Экран создания заказа + расчёт цены + отправка (2–3 недели)
3. Список заказов клиента + детальная карточка + статусы (1–2 недели)
4. Пул заказов для курьера + кнопка «Взять» + смена статусов (2 недели)
5. Уведомления через бота + чат внутри заказа (1–2 недели)
6. Загрузка и отображение фотографий посылки (1 неделя)
7. Базовая админка / модерация + метрики (1 неделя)
8. Тестирование + полировка + деплой (1–2 недели)

## 12. Замечания и риски MVP

- Самый большой риск — **недостаток курьеров** на старте → заказы будут висеть долго → клиенты будут уходить
- Решение: на первых порах можно вручную добавлять тестовых курьеров или запускать в одном небольшом районе
- Второй риск — **мошенничество** (фальшивые заказы, подмена initData, спам) → обязательна серверная проверка initData
- Третий риск — **низкое качество адресов** → клиенты пишут «возле пятёрочки» → курьер не может найти → много отмен

Конец спецификации MVP  
CourierMini — Telegram Mini App  
версия документа 1.0 от 24 февраля 2026
