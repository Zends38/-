# CourierMini — Техническое задание (MVP)  
Telegram Mini App — служба экспресс-доставки

**Дата:** 24 февраля 2026  
**Статус:** черновик MVP  
**Язык интерфейса:** Русский (обязательно)  
**Язык документации:** Русский  
**Тип приложения:** Telegram Mini App (Web App)

## 1. Цели и аудитория

**Главная цель**  
Дать возможность любому пользователю Telegram за 15–30 секунд вызвать курьера для доставки небольшого груза / документов / посылки «от двери до двери».

**Ключевые ценности MVP:**
- Максимально быстрое создание заказа
- Минимум полей для заполнения
- Работа полностью внутри Telegram
- Простая система для курьеров (принять → забрать → доставить)

**Целевая аудитория MVP**
- 18–45 лет
- Активные пользователи Telegram
- Жители городов-миллионников
- Типичные кейсы: документы, цветы, еда из магазинов, небольшие посылки до 5–8 кг

## 2. Технический стек (рекомендация 2026)

- Frontend: React / Vite + TypeScript  
  (альтернативы: Next.js App Router, Vue, SvelteKit)
- Telegram Web App SDK: `@telegram-apps/sdk-react` или `@tma.js/sdk`
- State management: Zustand / Jotai / React Context
- UI-библиотека:shadcn/ui + Tailwind CSS (или Telegram-совместимые компоненты)
- Backend: Node.js (Fastify / NestJS) / serverless (Vercel / Cloudflare Workers)
- База данных: PostgreSQL + Prisma / Supabase Postgres / Firebase
- Хранение файлов (фото посылок): Supabase Storage / Cloudflare R2 / S3-совместимое
- Аутентификация: Telegram `initData` (обязательная серверная валидация)
- Уведомления: Telegram Bot API (sendMessage)
- Платежи (опционально в MVP): Telegram Stars / ЮKassa / CloudPayments

## 3. Роли пользователей

| Роль          | Основные действия в MVP                                      |
|---------------|---------------------------------------------------------------|
| Клиент        | Создаёт заказ, отслеживает статус, общается с курьером        |
| Курьер        | Видит новые заказы, принимает, меняет статусы, общается       |
| Администратор | (минимально) просмотр заказов, блокировка пользователей       |

## 4. Структура навигации (MainButton + Bottom Menu)

| Экран                  | Для кого   | Ключевые элементы интерфейса                                      |
|------------------------|------------|-------------------------------------------------------------------|
| Главный / Создать заказ| Клиент     | Кнопка «Вызвать курьера», быстрые шаблоны, текущие заказы         |
| Мои заказы             | Клиент     | Список активных + завершённых, статус, кнопка «Связаться»         |
| Заказы (пулы)          | Курьер     | Список новых заказов, сортировка (цена / расстояние / срочность)  |
| Детали заказа          | Все        | Адреса, описание, фото, чат, кнопки изменения статуса             |
| Профиль                | Все        | Баланс, статус курьера, настройки уведомлений, контакты           |
| Онбординг (первый запуск) | Все     | 3–4 слайда + кнопка «Начать»                                      |

## 5. Основной сценарий — Клиент

1. Открывает Mini App
2. (первый раз) → онбординг 3–4 экрана
3. Нажимает «Вызвать курьера» / «Новый заказ»
4. Заполняет минимум полей:
   - Откуда забрать (геолокация Telegram или ручной ввод адреса)
   - Куда доставить
   - Что везём (выбор из 5–7 категорий + поле «описание»)
   - Вес / габариты (примерно)
   - Когда нужно: «Как можно скорее» / выбор времени
   - Фото посылки (опционально, 1–3 фото)
   - Комментарий
5. Видит расчётную стоимость (или «договоримся с курьером»)
6. Нажимает «Найти курьера»
7. Получает статусы: «Ищем курьера» → «Курьер назначен» → чат открывается

## 6. Основной сценарий — Курьер

1. В профиле включает статус «Готов брать заказы»
2. На вкладке «Заказы» видит карточки новых заявок
3. Карточка содержит:
   - Расстояние
   - Предполагаемая оплата
   - Категория и краткое описание
   - Время создания / срочность
4. Нажимает «Взять заказ» → закрепление за курьером
5. Меняет статусы:
   - Принял → Забрал → В пути → Доставлено
6. После «Доставлено» клиент подтверждает → заказ завершён

## 7. Структура данных (пример)

```ts
interface Order {
  id:                string;                    // uuid
  clientTgId:        number;                    // telegram user id
  courierTgId:       number | null;
  fromAddress:       string;
  toAddress:         string;
  pickupGeo?:        { lat: number; lng: number };
  dropoffGeo?:       { lat: number; lng: number };
  category:          'documents' | 'package' | 'flowers' | 'food' | 'other';
  description:       string;
  weightKgApprox:    number;                    // 0.5, 1, 3, 5, 8...
  photos:            string[];                  // url-ы
  price:             number | null;             // если null → договариваются
  status:            'new' | 'accepted' | 'picked_up' | 'in_progress' | 'delivered' | 'cancelled' | 'problem';
  createdAt:         string;                    // ISO
  pickupDesiredAt:   string | 'asap';
  completedAt?:      string;
  clientComment?:    string;
  courierComment?:   string;
}
